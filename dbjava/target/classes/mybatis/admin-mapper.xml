<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC 
	"-//mybatis.org//DTD Mapper 3.0//EN" 
	"https://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="com.javabang.repository.AdminDAO">
	
	<select id="selectAllRoom" parameterType="paging" resultType="rent">
		select * from rent
			order by
					idx desc
				offset #{offset} rows
				fetch next #{perPage} rows only
	</select>
	
	<update id="permitAccomodation" parameterType="int">
		update rent 
    		set state = 1 where idx = #{idx}
	</update>
	<update id="cencelAccomodation" parameterType="int">
		update rent 
    		set state = 0 where idx = #{idx}
	</update>
	
	<select id="selectCount" resultType="int">
		select count(*) from rent
	</select>
	
	<select id="selectAllReservation" resultType="reservation">
		select RV.*, M.userName, M.userId, RE.roomtype from reservation RV 
   			join member M on RV.member = M.idx
    		join rent RE on RV.rent = RE.idx
	</select>
	
	<select id="selectAllReservationSearch" parameterType="string" resultType="reservation">
		select RV.*, M.userName, M.userId, RE.roomtype from reservation RV 
   			join member M on RV.member = M.idx
    		join rent RE on RV.rent = RE.idx where M.userId like '%${search}%'
	</select> 
	
</mapper>